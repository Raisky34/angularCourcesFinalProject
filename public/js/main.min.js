function chatService(e,t){var a=firebase.database().ref().child("messages"),n=t(),o={};return o.getMessages=function(){return e(a)},o.getMessagesToShow=function(){return e(a.limitToLast(15))},o.addMessage=function(e){o.getMessages().$add(e)},o.login=function(){n.$signInWithPopup("google")},o.logout=function(){n.$signOut()},o}function chatCtrl(e,t){var a=this,n=t();a.messages=e.getMessages(),a.messagesToShow=e.getMessagesToShow(),a.addMessage=function(){var t={author:a.author.displayName,authorImg:a.author.photoURL,message:a.newMessage};""!=a.newMessage?(e.addMessage(t),a.newMessage=""):alert("Введите сообщение")},a.login=function(){e.login()},a.logout=function(){e.logout()},n.$onAuthStateChanged(function(e){a.author=e,console.log(a.author.photoURL)})}function enterClicker(){return function(e,t,a){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(a.enterClicker)}),t.preventDefault())})}}angular.module("chatApp",["firebase"]),angular.module("chatApp").factory("chatService",["$firebaseArray","$firebaseAuth",chatService]),angular.module("chatApp").controller("ChatCtrl",["chatService","$firebaseAuth",chatCtrl]),angular.module("chatApp").directive("enterClicker",[enterClicker]);